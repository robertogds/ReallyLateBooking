define(["Ti/_","Ti/_/lang"],function(t,r){function u(g,c){for(var b=[],i=[{cls:0,refs:[]}],a={},d=1,e=g.length,j=0,f,l,h,k,n;j<e;++j){if(f=g[j])if(m(f,"Object"))f=g[j]=s(f);else{if(!m(f,"Function"))throw Error('Base class not a function for "'+c+'" ['+j+"]");}else throw Error('Unknown base class for "'+c+'" ['+j+"]");l=f._meta?f._meta.bases:[f];h=0;for(f=l.length-1;0<=f;--f)k=l[f].prototype,k.hasOwnProperty("declaredClass")||(k.declaredClass="uniqName_"+v++),k=k.declaredClass,a.hasOwnProperty(k)||
(a[k]={count:0,refs:[],cls:l[f]},++d),k=a[k],h&&h!==k&&(k.refs.push(h),++h.count),h=k;++h.count;i[0].refs.push(h)}for(;i.length;){h=i.pop();b.push(h.cls);for(--d;n=h.refs,1==n.length;){h=n[0];if(!h||--h.count){h=0;break}b.push(h.cls);--d}if(h)for(j=0,e=n.length;j<e;++j)h=n[j],--h.count||i.push(h)}if(d)throw Error("Can't build consistent linearization for \""+c+'"');f=g[0];b[0]=f?f._meta&&f===b[b.length-f._meta.bases.length]?f._meta.bases.length:1:0;return b}function w(g,c){return function(){var b=
arguments,i=b,a=b[0],d,e,j;j=g.length;var f,l=this.declaredClass;p[l]||(p[l]=0);this.widgetId=l+":"+p[l]++;if(c&&(a&&a.preamble||this.preamble)){f=Array(g.length);f[0]=b;for(e=0;;){(a=b[0])&&(d=a.preamble)&&(b=d.apply(this,b)||b);d=g[e].prototype;(d=d.hasOwnProperty("preamble")&&d.preamble)&&(b=d.apply(this,b)||b);if(++e===j)break;f[e]=b}}for(e=j-1;0<=e;--e){d=g[e];if(j=d._meta)d=j.ctor,r.mixProps(this,j.hidden);m(d,"Function")&&d.apply(this,f?f[e]:b)}if(m(a,"Object"))for(e in d=this.constants,a)a.hasOwnProperty(e)&&
((d&&e in d?d.__values__:this)[e]=a[e]);this.toString===Object.prototype.toString&&(this.toString=function(){return"[object "+l.replace(/\./g,"")+"]"});(d=this.postscript)&&d.apply(this,i)}}function s(g){var c=new Function;o(c.prototype,g);c._meta={bases:[c],hidden:g};return c}function q(g,c){for(var b in c)c.hasOwnProperty(b)&&!/^(constructor|properties|constants|__values__)$/.test(b)&&(m(c[b],"Function")&&(c[b].nom=name),g[b]=c[b]);return g}var m=require.is,o=require.mix,v=0,p={};return t.declare=
function(g,c,b){m(g,"String")||(b=c,c=g,g="");var b=b||{},i=[b.constructor],a,d;d=1;var e={};a=m(c);"Array"===a?(i=u(c,g),c=i[d=i.length-i[0]]):"Function"===a?(a=c._meta,i=i.concat(a?a.bases:c)):"Object"===a?i[1]=c=s(c):c=0;if(c)for(d-=1;;--d){a=new Function;a.prototype=c.prototype;e=new a;if(!d)break;a=i[d];(a._meta?q:o)(e,a.prototype);a=new Function;a.superclass=c;a.prototype=e;c=e.constructor=a}q(e,b);a=b.constructor;a!==Object.prototype.constructor&&(a.nom="constructor",e.constructor=a);o(i[0]=
a=w(i,a),{_meta:{bases:i,hidden:b,ctor:b.constructor},superclass:c&&c.prototype,extend:function(a){q(this.prototype,a);return this},prototype:e});o(e,{constructor:a,isInstanceOf:function(a){for(var b=this.constructor._meta.bases,c=0,d=b.length;c<d;++c)if(b[c]===a)return!0;return this instanceof a}});g&&(e.declaredClass=g,r.setObject(g,a));return a}});