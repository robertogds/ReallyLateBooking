define("Ti/_,Ti/_/declare,Ti/_/has,Ti/_/lang,Ti/_/Evented,Ti/Network,Ti/Blob,Ti/_/event".split(","),function(i,j,g,e,h,m,k,l){var c=require.is,d=require.on;return j("Ti.Network.HTTPClient",h,{constructor:function(){var a=this._xhr=new XMLHttpRequest;this._handles=[d(a,"error",this,"_onError"),a.upload&&d(a.upload,"error",this,"_onError"),d(a,"progress",this,function(a){a.progress=a.lengthComputable?a.loaded/a.total:!1;c(this.ondatastream,"Function")&&this.ondatastream.call(this,a)}),a.upload&&d(a.upload,
"progress",this,function(a){a.progress=a.lengthComputable?a.loaded/a.total:!1;c(this.onsendstream,"Function")&&this.onsendstream.call(this,a)})];a.onreadystatechange=e.hitch(this,function(){var b=this.constants;switch(a.readyState){case 0:b.readyState=this.UNSENT;break;case 1:b.readyState=this.OPENED;break;case 2:b.readyState=this.LOADING;break;case 3:b.readyState=this.HEADERS_RECEIVED;break;case 4:clearTimeout(this._timeoutTimer),this._completed=1,b.readyState=this.DONE,200==a.status?(this.file&&
Filesystem.getFile(Filesystem.applicationDataDirectory,this.file).write(a.responseText),b.responseText=a.responseText,b.responseData=new k({data:a.responseText,length:a.responseText.length,mimeType:a.getResponseHeader("Content-Type")}),b.responseXML=a.responseXML,g("ti-instrumentation")&&instrumentation.stopTest(this._requestInstrumentationTest,this.location),c(this.onload,"Function")&&this.onload.call(this)):a.status/100|0&&this._onError()}this._fireStateChange()})},destroy:function(){this._xhr&&
(this._xhr.abort(),this._xhr=null);l.off(this._handles);h.destroy.apply(this,arguments)},_onError:function(a){this.abort();c(a,"Object")||(a={message:a});a.error||(a.error=a.message||this._xhr.status);parseInt(a.error)||(a.error="Can't reach host");c(this.onerror,"Function")&&this.onerror.call(this,a)},abort:function(){var a=this.constants;a.responseText=a.responseXML=a.responseData="";this._completed=!0;clearTimeout(this._timeoutTimer);this.connected&&this._xhr.abort();a.readyState=this.UNSENT;this._fireStateChange()},
_fireStateChange:function(){c(this.onreadystatechange,"Function")&&this.onreadystatechange.call(this)},getResponseHeader:function(a){return 1<this._xhr.readyState?this._xhr.getResponseHeader(a):null},open:function(a,b,c){var d=Ti.Network.httpURLFormatter,e=this.constants,f=this.withCredentials;this.abort();this._xhr.open(e.connectionType=a,e.location=i.getAbsolutePath(d?d(b):b),f||void 0===c?!0:!!c);f&&(this._xhr.withCredentials=f)},send:function(a){try{var b=this.timeout|0;this._completed=!1;g("ti-instrumentation")&&
(this._requestInstrumentationTest=instrumentation.startTest("HTTP Request"));a=c(a,"Object")?e.urlEncode(a):a;a&&this._xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this._xhr.send(a);clearTimeout(this._timeoutTimer);b&&(this._timeoutTimer=setTimeout(e.hitch(this,function(){this.connected&&(this.abort(),!this._completed&&this._onError("Request timed out"))}),b))}catch(d){}},setRequestHeader:function(a,b){this._xhr.setRequestHeader(a,b)},properties:{ondatastream:void 0,onerror:void 0,
onload:void 0,onreadystatechange:void 0,onsendstream:void 0,timeout:void 0,withCredentials:!1},constants:{DONE:4,HEADERS_RECEIVED:2,LOADING:3,OPENED:1,UNSENT:1,connected:function(){return this.readyState>=this.OPENED},connectionType:void 0,location:void 0,readyState:this.UNSENT,responseData:void 0,responseText:void 0,responseXML:void 0,status:function(){return this._xhr.status},statusText:function(){return this._xhr.statusText}}})});