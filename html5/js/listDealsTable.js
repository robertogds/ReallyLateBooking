(function(){var e;root.dealsTable=Titanium.UI.createTableView({data:[],backgroundColor:"#0d1e28",separatorColor:"#1b3c50"});e=Titanium.UI.createButton({title:"Mapa"});e.addEventListener("click",function(){root.listDealsMapView.annotations=root.annotations;return root.listDealsMapWindow.open()});root.listDealsWindow.rightNavButton=e;root.listDealsWindow.add(root.dealsTable);root.reloadDeals=!1;root.why3Row=(new root.GenericTextRow).row;root.why3Row.hasChild=!0;e=Titanium.UI.createLabel({text:L("why3Title"),
color:"#fff",font:{fontSize:14,fontWeight:"bold"},left:10,height:30});root.why3Row.add(e);root.dealsTable.addEventListener("click",function(a){return void 0===a.row.deal?root.why3Window.open():root.showDealView(a.row.deal)});root.showDeals=function(a){Ti.API.info("Entra en showDeals: "+a.length);root.citiesWindow.remove(root.errorView);0===a.length?(Ti.API.info("****** No hay hoteles activos en esta ciudad ********"),root.showNoDeals(),root.hideLoading(root.listDealsWindow),root.hideLoading(root.citiesWindow)):
root.cityHasZones(a)?root.populateDealsZoneTable(a):root.populateDealsTable(a);return Ti.API.info("*** Sale de showDeals")};root.cityHasZones=function(a){var c,d,b,f,g;d="null";b=0;for(f=0,g=a.length;f<g;f++)c=a[f],c.city.name!==d&&b++,d=c.city.name;return 1<b?!0:!1};root.populateDealsTable=function(a){var c,d,b,f;Ti.API.info("*** Entra en populateDealsTable");c=[];for(b=0,f=a.length;b<f;b++)d=a[b],d=new root.listDealsRow(d),c.push(d.row);c.push(root.why3Row);root.dealsTable.setData(c);Ti.API.info("*** LLama a EndPopulate");
return root.endPopulate()};root.populateDealsZoneTable=function(a){var c,d,b,f,g,e,h,i;Ti.API.info("*** Entra en populate Zonas ");d=[];g="empty";f=!0;e=Titanium.UI.createTableViewSection();for(h=0,i=a.length;h<i;h++)b=a[h],c=b.city,b=new root.listDealsRow(b),c.name!==g&&(Ti.API.info("Entra en CABECERA"),!0!==f&&d.push(e),g=new root.DealHeaderView(c.name),f=!1,e=Titanium.UI.createTableViewSection({headerView:g.view})),e.add(b.row),g=c.name;d.push(e);root.dealsTable.setData(d);root.endPopulate();return Ti.API.info("*** fin populateDealsZoneTable")};
root.endPopulate=function(){root.dealsTable.footerView=root.footerView;Ti.API.info("Entra en endPopulate");root.hideLoading(root.listDealsWindow);root.hideLoading(root.citiesWindow);!1===root.reloadDeals&&(Ti.API.info("*** Entra en abrir ventana"),root.nav.open(root.listDealsWindow,{animated:!0}));root.reloadDeals=!1;return Ti.API.info("Fin endPopulate")};root.loadDeals=function(a){Ti.API.info("Entra en loadDeals");root.showLoading(root.listDealsWindow,L("updatingHotels"));root.city=a;root.listDealsWindow.title=
a.name;root.noDealsWindow.title=a.name;return root.fetchDeals(a)}}).call(this);