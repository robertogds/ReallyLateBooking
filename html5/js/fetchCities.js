(function(){root.xhrCities=Titanium.Network.createHTTPClient();root.xhrCities.onload=function(){Ti.API.info("Entra en carga correcto");Ti.API.info(this.responseText);root.citiesLastUpdate=new Date;root.listCities=JSON.parse(this.responseText);if(0<root.listCities.length)return root.hideLoading(root.allCitiesWindow),root.populateCitiesTable(root.listCities)};root.xhrCities.onerror=function(a){Ti.API.info("Entra en error de ciudades onerror "+a.error);root.hideLoading(root.allCitiesWindow);Ti.UI.createAlertDialog({title:"ReallyLateBooking",
message:"Error: "+L("conectionError")}).show();return root.allCitiesWindow.close()};root.fetchCities=function(){var a;Ti.API.info("Entra en get Cities");if(!1===Titanium.Network.online)return Ti.UI.createAlertDialog({title:"ReallyLateBooking",message:L("mustInternet")}).show(),root.showError(root.allCitiesWindow);a=new Date;void 0===root.listCities?a=433E5:(a=a.getTime()-root.citiesLastUpdate.getTime(),Ti.API.info("last cities updated: "+root.citiesLastUpdate.toLocaleDateString()+"difftime: "+a));
if(void 0===root.listCities||432E5<a||0===root.listCities.length)return root.showLoading(root.allCitiesWindow),root.xhrCities.setTimeout(15E3),root.xhrCities.open("GET",root.url+"/v2/cities"),Ti.API.info("GET cities from: "+root.url+"/v2/cities"),root.xhrCities.setRequestHeader("Accept-Language",Titanium.Locale.currentLanguage),root.xhrCities.send();Ti.API.info("No se necesita cargar ciudades");return root.populateCitiesTable(root.listCities)};root.mockFetchCities=function(){Ti.API.info("Entra en cargar ciudades estat\u00edco");
return root.populateCitiesTable(root.staticCities)}}).call(this);