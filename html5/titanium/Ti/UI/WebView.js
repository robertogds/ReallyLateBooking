define("Ti/_/declare,Ti/_/UI/Widget,Ti/_/dom,Ti/_/event,Ti/_/lang,Ti/_/text!Ti/_/UI/WebViewBridge.js,Ti/App,Ti/API,Ti/UI".split(","),function(j,d,c,k,l,m,e,n,h){var i=require.on;return j("Ti.UI.WebView",d,{constructor:function(){e.addEventListener(this.widgetId+":unload",l.hitch(this,function(){this._loading(1)}));this.backgroundColor="#fff"},_preventDefaultTouchEvent:!1,destroy:function(){e.removeEventListener(this.widgetId+":unload");this._destroy();d.prototype.destroy.apply(this,arguments)},_destroy:function(){this._iframe&&
(k.off(this._iframeHandles),c.destroy(this._iframe))},_createIFrame:function(){if(this._parent){this._destroy();this._loading(1);var a=this.url||"",b=a.match(/(https?)\:\/\/([^\:\/]*)(:?\d*)(.*)/),f=window.location,d=!b||b[0]+":"===f.protocol&&b[1]+b[2]===window.location.host,g=this._iframe=c.create("iframe",{frameborder:0,marginwidth:0,marginheight:0,hspace:0,vspace:0,scrolling:this.showScrollbars?"auto":"no",src:a||require.toUrl("Ti/_/UI/blank.html"),style:{width:"100%",height:"100%"}},this.domNode);
this._iframeHandles=[i(g,"load",this,function(){var a=Math.max(d|0,0),b=g.contentWindow,f,c,e;if(-1!==a)d=-1;else for(f in b){a++;break}0<a?(c=b.location.href,this.evalJS(m.replace("WEBVIEW_ID",this.widgetId+":unload")),(e=this.properties.__values__.html)&&this._setContent(e)):n.warn("Unable to inject WebView bridge into cross-domain URL, ignore browser security message");this._loading();this.fireEvent("load",{url:c?this.properties.__values__.url=c:this.url})}),i(g,"error",this,function(){this._loading();
this.fireEvent("error",{message:"Page failed to load",url:this.url})})];return 1}},_setParent:function(a){d.prototype._setParent.apply(this,arguments);(this.url||this.html)&&this._createIFrame()},_getWindow:function(){return this._iframe.contentWindow},_getDoc:function(){return this._getWindow().document},_getHistory:function(){return this._getWindow().history},_loading:function(a){this.loading||a&&this.fireEvent("beforeload",{url:this.url});this.constants.loading=!!a},canGoBack:function(){return this.url&&
!!this._getHistory().length},canGoForward:function(){return this.url&&!!this._getHistory().length},evalJS:function(a){var b=this._getWindow(),c=null;try{c=a&&b&&b.eval&&b.eval(a)}catch(d){}return c},goBack:function(){if(this.canGoBack()){var a=this._getHistory();a&&(this._loading(1),a.go(-1))}},goForward:function(){if(this.canGoForward()){var a=this._getHistory();a&&(this._loading(1),a.go(1))}},reload:function(){var a=this._getWindow();this.url&&a?a.location.href=this.url:this._createIFrame()},stopLoading:function(a){try{this.loading&&
a?this._destroy():this._getWindow().stop()}catch(b){}this._loading()},_defaultWidth:h.FILL,_defaultHeight:h.FILL,_getContentSize:function(){return{width:this._iframe?this._iframe.clientWidth:0,height:this._iframe?this._iframe.clientHeight:0}},_setContent:function(a){try{var b=this._getDoc();b.open();b.write(a);b.close()}catch(c){}return a},properties:{data:{set:function(a){var b=a;switch(b&&b.declaredClass){case "Ti.Filesystem.File":b=b.read();case "Ti.Blob":b=b.toString();default:this.html=b}return a}},
html:{get:function(a){var b=this._iframe&&this._getDoc();return void 0===a&&b?b.documentElement.innerHTML:a},post:function(a){var b=this.properties.__values__;b.data=void 0;b.url=void 0;this._createIFrame()&&this._setContent(a)}},showScrollbars:{set:function(a){this._iframe&&c.attr.set(this._iframe,"scrolling",a?"auto":"no");return a},value:!0},url:{post:function(){var a=this.properties.__values__;a.data=void 0;a.html=void 0;this._createIFrame()}}},constants:{loading:!1}})});