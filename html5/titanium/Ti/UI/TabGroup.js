define(["Ti/_/declare","Ti/_/UI/SuperView","Ti/UI/View","Ti/UI","Ti/_/lang"],function(h,i,k,e,g){var j=require.is,f=e.FILL,d={post:"_updateTabsBackground"};return h("Ti.UI.TabGroup",i,{constructor:function(a){this.constants.tabsAtBottom=g.val(a&&a.tabsAtBottom,this.constants.tabsAtBottom);this._tabBarContainer=new (h(k,{declaredClass:"Ti.UI.TabBarContainer"}))({width:f,layout:e._LAYOUT_CONSTRAINING_HORIZONTAL});this.tabHeight=75;this._tabContentContainer=e.createView({width:f,height:f});this.layout=
e._LAYOUT_CONSTRAINING_VERTICAL;this.tabs=[];this.tabsAtBottom=g.val(a&&a.tabsAtBottom,!0)},addTab:function(a){var b=this.tabs=this.tabs||[];b.push(a);a._setTabGroup(this);1===b.length?this.activeTab=a:this._tabBarContainer._add(this._createTabDivider());this._tabBarContainer._add(a);this._updateTabBackground(a);this._publish(a)},_addTabContents:function(a){this._tabContentContainer._add(a)},_removeTabContents:function(a){this._tabContentContainer._remove(a)},removeTab:function(a){var b=this.tabs,
c=this.tabs.indexOf(a);0<=c&&(b.splice(c,1),this._tabBarContainer.remove(a),a===this._activeTab&&this._activateTab(b[0]),this._unpublish(a))},_createTabDivider:function(){return e.createView({width:this.tabDividerWidth,height:f,backgroundColor:this.tabDividerColor})},close:function(){this._previousTab=null;i.prototype.close.call(this)},_getEventData:function(){var a=this.tabs,b=this._previousTab,c=this._activeTab;return{index:c&&a.indexOf(c),previousIndex:b&&a.indexOf(b),tab:c,previousTab:b}},_handleFocusEvent:function(){var a=
this._previousTab,b=this._activeTab;a&&a._blur();!this._focused&&this._opened&&(this.fireEvent("focus",this._getEventData()),b&&b._focus());this._focused=1},_handleBlurEvent:function(a){if(a){for(var b=0,c=this.tabs.length,d;b<c;)d=this.tabs[b++],(2!==a||d===this._activeTab)&&d._blur();this._previousTab=void 0}this._focused&&this._opened&&this.fireEvent("blur",this._getEventData());this._focused=0},_activateTab:function(a){var b=this._activeTab;if(b!==a){if(this._previousTab=b)b.active=!1,b._doBackground();
e.currentTab=this._activeTab=a;a.active=!0;this._updateTabsBackground()}},_updateTabBackground:function(a){var b=a.active?"activeTab":"tabs";["","Focused","Disabled","Selected"].forEach(function(c){c="Background"+c;a["_default"+c+"Color"]=this[b+c+"Color"];a["_default"+c+"Image"]=this[b+c+"Image"]},this);a._doBackground()},_updateTabsBackground:function(){for(var a=this.tabs,b=0,c=a.length;b<c;)this._updateTabBackground(a[b++])},_updateDividers:function(){for(var a=this._tabBarContainer._children,
b=1;b<a.length;b+=2){var c=a[b];c.width=this.tabDividerWidth;c.backgroundColor=this.tabDividerColor}},_defaultWidth:f,_defaultHeight:f,properties:{activeTab:{set:function(a){j(a,"Number")&&(a=this.tabs[a]);return!a in this.tabs?void 0:a},post:function(a){g.isDef(a)&&this._activateTab(a)}},tabs:{set:function(a){if(j(a,"Array")){var b,c=this._tabBarContainer;c._removeAllChildren();if(a.length){this._activateTab(a[0]);for(b=0;b<a.length-1;b++)this._publish(a[b]),c._add(a[b]),c._add(this._createTabDivider());
c._add(a[a.length-1])}return a}},post:"_updateTabsBackground"},tabsAtBottom:{set:function(a,b){if(a!==b){var c=this._tabContentContainer,d=this._tabBarContainer;this._activeTab&&this._activeTab._setNavBarAtTop(a);this._remove(c);this._remove(d);a?(this._add(c),this._add(d)):(this._add(d),this._add(c))}return a}},activeTabBackgroundColor:{post:"_updateTabsBackground",value:"#fff"},activeTabBackgroundImage:d,activeTabBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#888"},activeTabBackgroundDisabledImage:d,
activeTabBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},activeTabBackgroundFocusedImage:d,activeTabBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},activeTabBackgroundSelectedImage:d,tabsBackgroundColor:{post:"_updateTabsBackground",value:"#aaa"},tabsBackgroundImage:d,tabsBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#666"},tabsBackgroundDisabledImage:d,tabsBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},tabsBackgroundFocusedImage:d,
tabsBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},tabsBackgroundSelectedImage:d,tabDividerColor:{post:"_updateDividers",value:"#555"},tabDividerWidth:{post:"_updateDividers",value:1},tabHeight:{set:function(a){return this._tabBarContainer.height=a}}}})});