define(["Ti/_/declare","Ti/_/lang","Ti/_/Gestures/GestureRecognizer"],function(f,g,h){return f("Ti._.Gestures.Pinch",h,{name:"pinch",_touchStartLocation:null,_fingerDifferenceThresholdTimer:null,_startDistance:null,_previousDistance:null,_previousTime:null,_fingerDifferenceThreshold:100,_driftThreshold:25,processTouchStartEvent:function(a){var b=a.changedTouches[0].clientX,c=a.changedTouches[0].clientY,d=a.touches.length,e=a.changedTouches.length;1==d&&1==e?(this._touchStartLocation=[{x:b,y:c}],this._fingerDifferenceThresholdTimer=
setTimeout(g.hitch(this,function(){this._touchStartLocation=null}),this._fingerDifferenceThreshold)):2==d&&1==e?(clearTimeout(this._fingerDifferenceThresholdTimer),this._touchStartLocation&&(this._touchStartLocation.push({x:b,y:c}),this._startDistance=Math.sqrt(Math.pow(this._touchStartLocation[0].x-this._touchStartLocation[1].x,2)+Math.pow(this._touchStartLocation[0].y-this._touchStartLocation[1].y,2)))):2==d&&2==e?(this._touchStartLocation=[{x:b,y:c},{x:a.changedTouches[1].clientX,y:a.changedTouches[1].clientY}],
this._startDistance=Math.sqrt(Math.pow(this._touchStartLocation[0].x-this._touchStartLocation[1].x,2)+Math.pow(this._touchStartLocation[0].y-this._touchStartLocation[1].y,2))):this._touchStartLocation=null},processTouchEndEvent:function(a,b){this.processTouchMoveEvent(a,b);this._touchStartLocation=null},processTouchMoveEvent:function(a,b){if(this._touchStartLocation&&2==this._touchStartLocation.length&&2==a.touches.length){var c=Math.sqrt(Math.pow(a.touches[0].clientX-a.touches[1].clientX,2)+Math.pow(a.touches[0].clientY-
a.touches[1].clientY,2)),d=0,e=(new Date).getTime();this._previousDistance&&(d=Math.abs(this._previousDistance/this._startDistance-c/this._startDistance)/((e-this._previousTime)/1E3));this._previousDistance=c;this._previousTime=e;b._isGestureBlocked(this.name)||b._handleTouchEvent(this.name,{scale:c/this._startDistance,velocity:d,source:this.getSourceNode(a,b)})}},processTouchCancelEvent:function(){this._touchStartLocation=null}})});