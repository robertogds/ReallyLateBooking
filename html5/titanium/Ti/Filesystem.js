define(["Ti/_","Ti/_/Evented","Ti/_/lang","Ti/Filesystem/File"],function(j,k,f,b){function g(){var d=/(.+:\/\/)?(.*)/,a="",e=[],b,c=f.toArray(arguments).filter(function(a){return void 0!==a}).map(function(b){a||(a=b.match(d))&&(a=a[1]||"");return b.replace(a,"").replace(/^\/|\/$/g,"")}).join("/");c.split("/").forEach(function(a){if(".."===a&&".."!==b){if(!e.length)throw Error('Irrational path "'+c+'"');e.pop();b=e[e.length-1]}else a&&"."!==a&&e.push(b=a)});c=a+e.join("/");!a&&!/^\//.test(c)&&(c="/"+
c);return c}function h(d){var a=new b({_type:d.charAt(0),nativePath:i+j.uuid()});return a["create"+d]()?a:null}var i="tmp://";return f.setObject("Ti.Filesystem",k,{constants:{MODE_APPEND:4,MODE_READ:1,MODE_WRITE:2,applicationDataDirectory:"appdata://",lineEnding:"\n",resourcesDirectory:"/",separator:"/",tempDirectory:i},protocols:["appdata","tmp"],createTempDirectory:function(){return h("Directory")},createTempFile:function(){return h("File")},getFile:function(){return new b(g.apply(null,arguments))},
isExternalStoragePresent:function(){return!1},openStream:function(d){var a=f.toArray(arguments);a.shift();return(new b(g.apply(null,a))).open(d)}})});