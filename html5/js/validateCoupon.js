(function(){root.xhrValidateCoupon=Titanium.Network.createHTTPClient({timeout:15E3});root.xhrValidateCoupon.onload=function(){var a;Ti.API.info(this.responseText);Ti.API.info("_____________________ COUPON VALIDADO CON EXITO ********************");root.hideLoading(root.creditsWindow);try{a=JSON.parse(this.responseText)}catch(b){Ti.UI.createAlertDialog({title:"ReallyLateBooking",message:L("errorBooking")}).show()}Ti.API.info(a);if(201===a.status)return root.fetchCreditsConnect();Ti.API.error("error de compra");
return Ti.UI.createAlertDialog({title:"ReallyLateBooking",message:"Error: "+a.detail}).show()};root.xhrValidateCoupon.onerror=function(a){root.hideLoading(root.creditsWindow);root.showError();return Ti.API.error(a)};root.validateCoupon=function(a){var b,c;Ti.API.info("_____________________ ENTRA EN VALIDAR COUPON ********************");c=root.urlSignature("/coupon");b=root.doSignature(c);root.xhrValidateCoupon.open("POST",root.surl+(c+"/"+b));root.xhrValidateCoupon.setRequestHeader("Content-Type",
"application/json; charset=utf-8");root.xhrValidateCoupon.setRequestHeader("Accept-Language",Titanium.Locale.currentLanguage);b={};b.id=root.user.id;a=JSON.stringify({user:b,key:a});Ti.API.info(a);Ti.API.info("Paso pre-compra");root.xhrValidateCoupon.send(a);return Ti.API.info("Paso post-compra")}}).call(this);