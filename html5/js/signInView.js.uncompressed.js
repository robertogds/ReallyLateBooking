// Generated by CoffeeScript 1.3.3
(function() {
  var loginLabel, signInButton;

  Ti.include('/js/loginTable.js');

  root.signInView = Titanium.UI.createView({
    background: "transparent",
    top: 0,
    text: "sign in"
  });

  loginLabel = Titanium.UI.createLabel({
    text: L('orLoginLabel') + ':',
    textAlign: 'center',
    color: '#fff',
    font: {
      fontSize: 14,
      fontWeight: 'bold'
    },
    height: 30,
    top: 65
  });

  signInButton = new root.GenericButton(210, Ti.Locale.getString('signIn')).button;

  signInButton.addEventListener('click', function(e) {
    var email, password, validate;
    email = root.emailText.value;
    password = root.passText.value;
    validate = root.validateLoginData(email, password);
    if (validate === true) {
      password = Titanium.Utils.md5HexDigest(password);
      root.showLoading(root.signInView);
      return root.doLogin(email, password);
    } else {
      return Ti.UI.createAlertDialog({
        title: 'ReallyLateBooking',
        message: L('reviewData') + validate
      }).show();
    }
  });

  root.rememberPassView = new root.Generic2RowsView(290, L('IForgotPassword'), L('needAccount'));

  root.rememberPassView.table.height = 44;

  root.rememberPassView.label1.addEventListener('click', function(e) {
    return root.tabGroup.activeTab.open(root.rememberPassWindow, {
      animated: true
    });
  });

  root.rememberPassView.label2.addEventListener('click', function(e) {
    Ti.API.info('Entra en create new account');
    root.signInWindow.close();
    Ti.API.info('llama a showNewAccount');
    root.showNewAccount();
    return Ti.API.info('Fin click');
  });

  root.showSignInView = function(source) {
    if (source === 'booking') {
      root.rememberPassView.table.height = 88;
    } else {
      root.rememberPassView.table.height = 44;
    }
    root.tabGroup.activeTab.open(root.signInWindow, {
      animated: true
    });
    return root.hideLoading(root.oneDealWindow);
  };

  root.signInView.add(root.facebookLoginButton);

  root.signInView.add(loginLabel);

  root.signInView.add(root.loginTable);

  root.signInView.add(signInButton);

  root.signInView.add(root.rememberPassView.view);

  root.signInWindow.add(root.signInView);

}).call(this);
