define(["Ti/_/declare","Ti/_/Evented","Ti/_/lang","Ti/Platform"],function(h,i,j,k){function f(a,b,c){var e=0==b?1:0,b=2==b?1:2,d=0==a?1:0,a=2==a?1:2;return c[d][e]*c[a][b]-c[d][b]*c[a][e]}function g(a,b,c,e,d,f,g,h){return{a:a.a*b+a.b*e,b:a.a*c+a.b*d,c:a.c*b+a.d*e,d:a.c*c+a.d*d,tx:a.a*f+a.b*g+a.tx,ty:a.c*f+a.d*g+a.ty,rotation:a.rotation+(h|0)}}var l="gecko"===k.runtime,d;return d=h("Ti.UI.2DMatrix",i,{properties:{a:1,b:0,c:0,d:1,tx:0,ty:0,rotation:0},constructor:function(a){a&&require.mix(this,a)},
invert:function(){var a=0,b=0,c=[[this.a,this.b,this.tx],[this.c,this.d,this.ty],[0,0,1]],e=this.a*f(0,0,c)-this.b*f(0,1,c)+this.tx*f(0,2,c);if(1.0E-10<Math.abs(e))for(e=1/e;3>b;b++)for(;3>a;a++)c[b][a]=f(a,b,c)*e,1==(a+b)%2&&(c[b][a]=-c[b][a]);return new d(g(this,c[0][0],c[0][1],c[1][0],c[1][1],c[0][2],c[1][2]))},multiply:function(a){return new d(g(this,a.a,a.b,a.c,a.d,a.tx,a.ty,a.rotation))},rotate:function(a){return new d({a:this.a,b:this.b,c:this.c,d:this.d,tx:this.tx,ty:this.ty,rotation:this.rotation+
a})},scale:function(a,b){return new d(g(this,a,0,0,j.val(b,a),0,0))},translate:function(a,b){return new d(g(this,1,0,0,1,a,b))},toCSS:function(){for(var a=0,b=[this.a,this.b,this.c,this.d,this.tx,this.ty];6>a;a++)b[a]=b[a].toFixed(6),4<a&&(b[a]=l?b[a]+"px":b[a]);return"matrix("+b.join(",")+") rotate("+this.rotation+"deg)"}})});