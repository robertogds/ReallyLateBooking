// Generated by CoffeeScript 1.3.3
(function() {
  var beginReloading, endReloading, pulling, reloading, tableHeader;

  tableHeader = new root.PullRefreshHeader();

  root.creditsTable.headerPullView = tableHeader.view;

  pulling = false;

  reloading = false;

  beginReloading = function() {
    root.reloadcredits = true;
    root.showCreditsConnect();
    return setTimeout(endReloading, 3000);
  };

  endReloading = function() {
    reloading = false;
    tableHeader.lastUpdatedLabel.text = L('lastUpdated') + ': ' + root.formatDate();
    tableHeader.statusLabel.text = L('pullRefresh') + '...';
    tableHeader.actInd.hide();
    return tableHeader.arrow.show();
  };

  root.creditsTable.addEventListener('scroll', function(e) {
    var offset, t;
    offset = e.contentOffset.y;
    if (offset <= -65.0 && !pulling) {
      t = Ti.UI.create2DMatrix();
      t = t.rotate(-180);
      pulling = true;
      tableHeader.arrow.animate({
        transform: t,
        duration: 180
      });
      return tableHeader.statusLabel.text = L('releaseRefresh') + '...';
    } else if (pulling && offset > -65.0 && offset < 0) {
      pulling = false;
      t = Ti.UI.create2DMatrix();
      tableHeader.arrow.animate({
        transform: t,
        duration: 180
      });
      return tableHeader.statusLabel.text = L('pullRefresh') + '...';
    }
  });

  root.creditsTable.addEventListener('scrollEnd', function(e) {
    if (pulling && !reloading && e.contentOffset.y <= -65.0) {
      reloading = true;
      pulling = false;
      tableHeader.arrow.hide();
      tableHeader.actInd.show();
      tableHeader.statusLabel.text = L('reloading') + '...';
      tableHeader.arrow.transform = Ti.UI.create2DMatrix();
      return beginReloading();
    }
  });

}).call(this);
